# Provide the backdoor entries created by the nation state attackers. 

# Rouge Username

darklord:x:1001:1001:,,,:/home/darklord:/bin/bash
"darklord"

# Backdoor process name

*Presitance process name of the malware*

root@ubuntu-VirtualBox:/var/log# ps -axjf | grep "darklord"
 3110  3280  3279  3093 pts/0     3279 S+       0   0:00          |                   \_ grep --color=auto darklord
root@ubuntu-VirtualBox:/var/log# ps aux | grep "darklord"
root      3293  0.0  0.0   4676   828 pts/0    S+   15:27   0:00 grep --color=auto darklord
root@ubuntu-VirtualBox:/var/log# ps -axjf | grep "darklord"
 3110  3369  3368  3093 pts/0     3368 S+       0   0:00          |                   \_ grep --color=auto darklord


*Presitance Port # of the malware*
# Backdoor port number the above process is listening on

tcp        0      0 0.0.0.0:56565           0.0.0.0:*               LISTEN      998/remotesec
 
root@ubuntu-VirtualBox:/# ps -fp 998
UID        PID  PPID  C STIME TTY          TIME CMD
root       998   997  0 15:18 ?        00:00:00 /tmp/remotesec -k -l 56565



# To Remove everything associate with "remotesec" and "darklord" on Linux machine #

# remove the presitance file name "remotesec"

root@ubuntu-VirtualBox:/tmp# rm /etc/remotesec
root@ubuntu-VirtualBox:/tmp# rm /root/remotesec

# find username "darklord" in the linux machine #
root@ubuntu-VirtualBox:/# id darklord
uid=1001(darklord) gid=1001(darklord) groups=1001(darklord)

root@ubuntu-VirtualBox:/# grep "^darklord" /etc/passwd
darklord:x:1001:1001:,,,:/home/darklord:/bin/bash

# remove "darklord username 
root@ubuntu-VirtualBox:/# userdel -r -f darklord
userdel: darklord mail spool (/var/mail/darklord) not found

Command: find . -type f -exec grep "remotesec" '{}' \; -print 
Descriptio below: 

###
This goes through every object in the current directory tree (.) that’s a file (-type f) and then runs grep ” forinstance ” for every file that matches, then prints them on the screen (-print). The curly braces ({}) are a placeholder for those results matched by the Linux find command. The {} go inside single quotes (‘) so that grep isn’t given a misshapen file name. The -exec command is ended with a semicolon (;), which also needs an escape (\;) so that it doesn’t end up being interpreted by the shell.
###

# This command below will search everything assoicate with the name "remotesec" in all directories in Linux machine # 
root@ubuntu-VirtualBox:/home/ubuntu# find . -type f -exec grep "remotesec" '{}' \; -print
find . ~/ remotesec
sudo find . ~/ remotesec
nano /tmp/remotesec 
./.bash_history
Description: This script copy files to this path > "/tmp/remotesec -k -l 56565"
it run on port "5656". Also, this file is on timer "at -f remotesec now".
Name of the file: "remotesec"
"/tmp/remotesec -k -l 56565"
./Downloads/suspicious_file_report.txt
Description: This script copy files to this path > "/tmp/remotesec -k -l 56565"
it run on port "5656". Also, this file is on timer "at -f remotesec now".
Name of the file: "remotesec"
"/tmp/remotesec -k -l 56565"
./Downloads/suspicious_file_report.txt~

### remove files in /etc directory name "darklord" or "remotesec"

root@ubuntu-VirtualBox:/etc# rm -rf /etc/darklord.sh

# This command below will search everything assoicate with the name "darklord" in all directories in Linux machine # 

root@ubuntu-VirtualBox:/etc# find . -type f -exec grep "darklord" '{}' \; -print
darklord:x:1001:
./group-
darklord:231072:65536
./subuid-
darklord:$6$llD6fuxt$64Szwv70Raelky8k9M3esP3HQHaTT2/s8A/bpUoXUhRYg.MMJm8lJSxB9u8vuV2mk1DAY0U7AUZp7mEL4CQAn/:18527:0:99999:7:::
./shadow-
darklord:x:1001:1001:,,,:/home/darklord:/bin/bash
./passwd-
darklord:!::
./gshadow-
darklord:231072:65536
./subgid-
